---
title: 迭代器
categories: 
- ECMASCRIPT
---

# 迭代

迭代就是遍历

js提供了很多的方法

- for循环
- for in循环
- Array.prototype.forEach()

等

es6还提供了一种新的迭代方式，`for of循环`

但这种迭代形式和普通的循环方式不同，因为可以自定义

# 迭代协议

在es6中，补充了两个关于迭代的协议

是协议，不是语法

- 可迭代协议
- 迭代器协议

# 可迭代协议

`可迭代协议`允许 JavaScript 对象去定义或定制它们的迭代行为, 

为了变成`可迭代对象`， 一个对象(或者对象的原型)必须有一个` Symbol.iterator `的属性

这个属性是一个函数(没有参数)，这个函数会返回一个对象，这个对象必须符合`迭代器协议`

比如
```
var obj={
  c:1
}
obj[Symbol.iterator]=function(){
  return {}
} 
```

# 迭代器协议

迭代器协议就是规定一个对象必须有一个`next()`的方法

并且这个next方法的返回值必须是一个对象，这个对象的格式是

```
{
    done:true,
}
{
    value:1
}
{
    done:true/false
    value:1
}
```
如果done是true，则value可以省略，如果是false，则done可以省略

-----------------
如果为done为false，则表示会继续迭代，如果为false，就结束迭代

------------------------

可以看到，`可迭代协议`是依赖于`迭代器协议的`，想要实现自定义迭代，就得都实现这两个协议


# for of

es6中新添加的一个遍历`可迭代对象`的语法

也就是说，只要满足了这两个协议的对象，就可以使用这个语法来迭代

[示例代码](https://codepen.io/feibernren/pen/movxzM?editors=0012)


# links

- [https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols)