---
title: 异步函数
categories: 
- ECMASCRIPT
---

# async function(异步函数)


异步函数是指通过`事件循环`异步执行的函数，它会通过一个隐式的 Promise 返回其结果

语法:

```
async function name([param[, param[, ... param]]]) { statements }
```
申明一个异步函数很简单，使用`async操作符`

# 异步函数返回值

异步函数的返回值是一个`promise`

这个promise的状态和值由异步函数来确定

函数执行完毕后，promise的状态是fullfilled，promiseValue是函数的返回值

如果函数执行报错，promise状态是rejected，promiseValue就是抛出的`Error`

# await

如果异步函数仅仅是返回一个promise，那么就没什么意思了

重点是 异步函数中可以使用 `await`操作符来暂停async函数的执行
----------------

`await`操作符用于等待一个Promise对象

语法
```
[return_value] = await expression;

```
- expression如果是promise对象，则会等待promise的状态的改变(变成fullfilled/rejected)
- expression不是promise对象，则返回表达式运算的值


return_value更有意思

- 如果是fullfilled，return_value则是promiseValue
- 如果是rejected，则会直接抛出错误，这个错误应该被异步函数创建的promise来捕获

---------------

async/await的目的是简化使用`多个 promise 时的同步行为`，并对一组 Promises执行某些操作。

正如Promises类似于结构化回调，async/await类似于生成器和 promises的组合

# generator 和 async function

async function可以暂停，generator也可以暂停

但是async function却通过await操作符来自动判断是否执行`next()`方法

generator则是会手动执行

其实，async function是generator的语法糖

generator也可以通过promise来实现判断是否执行next()方法来达到自动执行的目的

[示例代码](https://codepen.io/feibernren/pen/ywZEjP?editors=0010)

