# 数据库

## 1、数据库系统概述

### 基本概念

#### 数据

##### 描述事物的------------------------符号记录

#### 数据库

##### 是指长期存储在计算机中的，有组织的，可共享的数据集合

##### 数据库中的数据

###### 三大特点

####### 可共享

####### 有组织

####### 永久存储

#### 数据库管理系统(DBMS)

##### 主要功能

###### 数据定义功能

###### 数据操纵功能

###### 数据库的建立维护功能

###### 数据库的运行管理功能

###### 数组组织、存储、管理功能

###### 与其他软件的网络通信功能

###### 不同数据库管理系统之间的数据传输和相互访问功能

#### 数据库系统

##### 主要角色

###### 数据库

###### 应用程序

###### DBMS及其相关工具

###### 数据库管理员

###### 用户

### 数据-----管理的发展历史

#### 人工管理阶段

##### 特点

###### 数据不保存

###### 数据由程序控制

###### 数据面向应用

#### 文件系统阶段

##### 特点

###### 将逻辑结构和物理结构分离

###### 存放方法实现两个结构映射

##### 缺点

###### 数据冗余

###### 共享性差

#### 数据库系统阶段

##### 特点

###### 数据集成

###### 数据共享性高

###### 冗余小

###### 数据一致性高

###### 数据独立性高

###### 统一的管理与控制

###### 减少引用程序开发和维护的工作量

### 数据库系统-----结构

#### 从运行与应用结构的角度看

##### C/S

###### 在数据库系统中，

###### 数据库的使用者使用客户端来连接DBMS

###### 进行查询和处理底层数据库中的各种数据

##### B/S

###### 在C/S的基础上，将客户端细分为表示层和逻辑层

###### 表示层负责展示使用者的操作界面

###### 逻辑层负责处理数据库和使用者的具体逻辑

###### 逻辑层和后台的DBMS共同组成更加丰富的`胖服务器`

#### 从DBA的角度看

##### 三级模式结构

###### 外模式

###### 模式

###### 内模式

### 数据模型

#### 三要素

##### 数据结构

##### 数据操作

##### 数据约束

#### 分类

##### 概念模型

###### 概念

####### 实体

######## 客观存在，并且可以相互区别的事物

####### 属性

######## 描述实体的某种特征

####### 码/键

######## 可唯一表示实体的----属性集

####### 域

######## 属性的取值范围

####### 实体形

####### 实体集

######## 实体的集合

####### 联系

######## 一般指，实体的属性之间的联系

###### 表示方法

####### ER图

###### 目的

####### 按照用户的观点来描述现实世界中的事物

##### 逻辑模型

###### 目的

####### 描述数据整体的逻辑结构

###### 分类

####### 层次模型

####### 网状模型

####### 关系模型

####### 面向对象模型

##### 物理模型

## 2、关系数据库

### 概述

### 关系数据模型

#### 关系模型的----------数据结构

##### 表

##### 关系

##### 列

##### 属性

##### 元祖

##### 码/键

###### 可以唯一标示元组的属性集合或属性，叫做key

##### 超码

###### 一个码X，移除一个属性，还是key的话，那么X就是超码

##### 候选码

###### 一个码X，只要移除任意一个就不是key，那么X就是候选码

##### 主码

###### 从候选码中任意选出一个的码就是主码

##### 全码

###### 一个关系中的所有属性，用U表示，只有U是主码，那么U就称为全码

##### 主属性

###### 存在于候选码中的属性

##### 非主属性

###### 不存在候选码中的属性

##### 外码

###### 不是本关系的候选码，而是其他关系的候选码

##### 参照关系/被参照关系

##### 域

##### 关系模式

#### 数据操作 

##### 关系代数

###### 从集合论发展而来

###### 分类

####### 传统的集合运算

######## 继承集合论的运算

######## 仅仅涉及到行

######## 操作符

######### 交

######### 差

######### 并

######### 笛卡尔积

####### 专门关系运算

######## 涉及到行和列

######## 操作符

######### 选择

######### 投影

######### 连接

######### 除

#### 完整性约束

##### 数据库的数据完整性是指------------数据的

###### 正确性

###### 相容性

###### 一致性

##### 关系模型特有的约束

###### 实体完整性

####### 主键不能为空

###### 参照完整性

###### 用户自定义完整性

#### 规范化理论

##### 起源

###### 不好的关系模式可能会有问题

####### 数据冗余

####### 插入异常

####### 更新异常

####### 删除异常

##### 相关概念

###### 函数依赖


> 这也就是“函数依赖”名字的由来，类似于函数关系 y = f(x)，在x的值确定的情况下，y的值一定是确定的。

####### 假设R为给定的关系

####### XY是R中的两个属性集

####### R中的任意两个元组，只要X属性值相同，Y的属性值就相同

####### 则称，Y函数依赖于X

####### 或X--------函数决定----------Y

####### 表示形式X->Y

####### 反之，则表示X不能------函数决定------Y

####### 表示为,X!->Y

###### 完全函数依赖

####### 假设R为任意一个给定的关系

####### XY是两个属性集合

####### X->Y

####### 但是，X的任意一个子集和Xn！--->Y

####### 则称为

####### Y完全函数依赖于X

###### 部分函数依赖

####### X存在一个真子集Xn，满足Xn->Y

####### 则Y部分函数依赖于X

###### 传递函数依赖

####### 有三个属性集，XYZ

####### 有如下关系

####### X->Y,Y->Z

####### 但是，Y!=X

####### 还有X->Z

####### 则说X函数传递依赖Z

###### 候选关键字

####### 给定的关系R中，所有的属性表示为U

####### X是U的子集合

####### X->U

####### 则X称为R的候选关键字

##### 范式(normal form)

###### 1NF

####### 给定的关系R中

####### R的每一行和每一列的交叉点，都无法再次分割

####### 则R满足第一范式

###### 2NF

####### 在1NF的基础上

####### 所有非主属性

####### 都完全函数依赖于

####### 候选关键字

###### 3NF

####### 在2NF的基础上

####### 每一个非主属性

####### 都不传递眼熟依赖于

####### 候选关键字

###### BCNF



1NF： 字段是最小的的单元不可再分 
2NF：满足1NF,表中的字段必须完全依赖于全部主键而非部分主键 (一般我们都会做到)
3NF：满足2NF,非主键外的所有字段必须互不依赖


## 3、数据库设计

### 概述

#### 数据库的生命周期

##### 数据库的分析和设计阶段

###### 需求分析

###### 概念设计

###### 逻辑设计

###### 物理设计

##### 数据库的实现和操作阶段

###### 数据库的实现

###### 操作与监督

###### 修改和调整

#### 设计的目标

##### 满足应用功能需求

##### 良好的数据库性能

#### 设计的内容

##### 结构设计

##### 行为设计

#### 设计的方法

##### 直观设计法

##### 规范设计法

##### 计算机辅助设计法

#### 设计的过程

##### 需求分析阶段

##### 结构设计阶段

###### 概念结构设计

###### 逻辑结构设计

###### 物理结构设计

##### 行为设计阶段

###### 功能设计

###### 事务设计

###### 程序设计

##### 数据库实施阶段

###### 数据库加载数据

###### 运行调试

##### 数据库运行和维护阶段

### 基本步骤

#### 需求分析

##### 确定数据库范围

##### 应用过程分析

##### 收集和分析数据

##### 编写需求分析报告

#### 概念结构设计

#### 逻辑结构设计

#### 物理设计

#### 数据库实施

#### 数据库运行和维护

### 设计方法

#### 概念结构设计阶段

##### ER图

##### 局部信息结构设计

##### 全局信息结构设计

#### 逻辑结构设计阶段

##### ER图转---------->关系模型

##### 模型优化

##### 设计子模式

#### 物理设计阶段

##### 建立索引

##### 建立聚集

## 4、SQL和关系数据库的基本操作

### sql概述

#### 特点

##### 简单易学

##### 不是某种数据库特有的语言

##### 功能强大

#### 四大功能

##### 数据查询

##### 数据定义

##### 数据操纵

##### 数据控制

### 基础知识

#### 架构

##### lamp

##### wamp

#### mysql中的----sql

##### 常量

##### 变量

##### 运算符

##### 表达式

##### 函数

###### 数学函数

####### ABS()

###### 聚合函数

####### COUNT()

###### 字符串函数

####### CHAR()

###### 日期函数

####### NOW()

####### YEAR()

###### 加密函数

####### ENCRYPT()

####### DECRYPT()

###### 流程控制函数

###### 格式化函数

###### 系统信息函数

### 数据定义

#### 数据库

##### 创建

##### 选择

##### 修改

##### 删除

##### 查看

#### 表

##### 创建

##### 更新

##### 重命名

##### 删除

##### 查看

##### 查询

###### 选择列

###### from

###### where

###### group

###### having

###### order

###### limit

#### 索引

##### 创建

##### 查看

##### 修改

##### 删除

### 数据更新

#### 插入数据

#### 修改数据

#### 删除数据

### 数据查询

### 视图

#### 和表的区别

##### 不是真实的表

##### 视图的内容由sql查询语句定义

#### 优势

##### 集中分散数据

##### 简化查询语句

##### 保护数据安全

##### 共享所需数据

##### 重用SQL语句

#### 操作

##### 创建

##### 删除

##### 修改

##### 查看

##### 更新视图的数据

##### 查询视图数据

## 5、数据库编程

### 存储过程

#### 本质

##### 存储在数据库中的代码

#### 组成部分

##### 申明式的SQL语句（create update等）

##### 过程式的SQL语句（IF THEN ELSE等）

#### 优点

##### 增强SQL的功能和灵活性

##### 良好的封装性

##### 高性能

##### 可减少网络流量

##### 是一种安全机制来保证数据库的安全性和数据的完整性

#### 语法

##### 申明

###### CRAETE PROCEDURE

####### 参数

######## 类型

######### IN

######### OUT

######### INOUT

####### 局部变量

######## 申明变量

######### DECLARE  val varchar(20)

######## 变量赋值

######### SET val="asdfadsf"

######## 选定列赋值

######### SELECT name TO val

####### 流程控制

######## 条件判断

######### IF

######### ELSE

######### THEN

######## 循环

######### WHILE

######### LOOP

########## LEAVE

######### REPEAT

####### 游标

######## 本质

######### 游标是一个被SELECT语句检索出来的结果集

######## 申明

######### DECLARE cursor_name CURSOR FOR select_statement

######## 打开

######### OPEN cursor_name

######## 读取

######### FETCH 。。。。。INTO....

######## 关闭

######### CLOSE

##### 调用

###### CALL procdure_name

##### 删除

###### DROP PROCDURE  procdure_name

### 存储函数

#### 区别

##### 不能有输出参数

##### 必须有RETURN语句

#### 语法

##### 创建

###### CREATE FUNCTION   fn_name

##### 调用

###### SELECT fn_name

##### 删除

###### DROP fn_name

## 6、数据库安全与保护

### 数据库完整性

#### 完整性约束的------------作用对象

##### 列

##### 元组

##### 表

#### 分类

##### 实体完整性

###### 通过主键约束和候选键约束实现

##### 参照完整性

###### 通过定义外键实现

##### 用户定义完整性

###### check约束

###### 非空约束

### 触发器

#### 定义在关系表上的一类由事件驱动的数据库对象

#### 类型

##### INSERT触发器

##### UPDATE触发器

##### DELTE触发器

#### 语法

##### 创建

###### CREATE TRIGGER

####### create trigger trigger_name AFTER INSERT

###### DROP TRIGGER

### 访问控制

#### 账号管理

##### 用户

###### 创建用户

####### CREATE USER

###### 删除用户

####### DROP USER

###### 修改用户

####### RENAME USER

##### 权限

###### 授权

####### GRANT

###### 收回

####### REVERKE

### 事务

#### 定义

##### 事物是用户定义的一个数据操作序列

#### 特征

##### ACID

###### ATOMICITY

####### 原子性

###### consistency

####### 一致性

###### isolation

####### 隔离线

###### durability

####### 持续性

#### 锁

##### 最常用的并发控制技术

##### 基本流程

###### 分支主题

##### 类型

###### exclusive  lock

####### 排它锁

######## X锁

######### 事务T对数据D枷锁L

########## 其他事务必须等到T解锁才可以操作数据D

######### 更新操作（insert ,update ,delete)需要X锁

###### shared lock

####### 共享锁

######## S锁

######### 读操作需要S锁

##### 级别

###### 0

###### 1

###### 2

###### 3

##### 活锁和死锁

### 备份和恢复

#### 原因

##### 硬件故障

##### 软件故障

##### 病毒

##### 人为误操作

##### 自然灾害

##### 盗窃

#### 语句

##### SELECT INTO   OUTFILE

##### LOAD DATA...............INFILE

## 7、数据库应用设计和开发实例

## 8数据库管理技术的发展

### 发展历程

#### 第一代数据库

#### 第二代数据库

#### 第三代数据库

### 数据仓库和数据挖掘

#### 数据仓库

##### 定义

###### 数据仓库是面向主题的，集成的稳定的，随时间变化的数据集合

##### 特点

###### 面向主题

###### 集成性

###### 数据的非易失性

###### 数据的时变性

#### 数据挖掘

### 大数据

#### 定义

##### 大数据是指无法在可容忍的时间内

##### 用现有的技术

##### 对其进行感知、获取、管理、处理的

##### 数据集合

#### 特征

##### 数据量巨大

###### 大量化

##### 数据种类繁多

###### 多样化

##### 处理速度快

###### 快速化

##### 价值密度低

#### 典型技术代表

##### 大数据存储

###### Hadoop

####### 分布式文件系统 hadoop distributed file system

##### noSql

###### key-value模型

####### redis

###### 文档模型

####### mongodb

###### 列存储

###### 图存储

##### MapReduce
